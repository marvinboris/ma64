import{c as E,r as P,j as e,u as $,m as L,z as O,F as d,i as g,L as j,k as I,n as J,R,N as A}from"./index-BncDn27B.js";import{B,S as V,a as z}from"./Subtitle-EIBA-Hk5.js";import{D as C,L as M}from"./Delete-DN_4O9m9.js";import{e as U}from"./Error-CC8F97pB.js";import{F as u}from"./Feedback-C0SvNv4r.js";import{T as q}from"./index-C0jNRMwo.js";import{V as G}from"./View-DYaRmNR8.js";import{g as H,d as K,r as Q}from"./posts-WRngtTc9.js";import"./app-BShz7gyO.js";import"./BreadcrumbItem-BLbML1-v.js";import"./Table-Cy8UlfKH.js";const f="blog";class X extends P.Component{componentDidMount(){var t,i;(i=(t=this.props).get)==null||i.call(t)}componentWillUnmount(){this.props.reset()}render(){var p,x,h;if(!((p=this.props.content)!=null&&p.cms)||!((x=this.props.backend)!=null&&x.posts)||!((h=this.props.auth)!=null&&h.data))return null;let{content:{cms:{pages:{components:{list:{action:t,see:i}},backend:{pages:{posts:{title:l,add:y,index:m,form:a}}}}}},backend:{posts:{loading:b,error:N,message:k,posts:n,total:_}},auth:{data:{role:{features:S}}}}=this.props;const o=S.find(s=>s.prefix==="posts"),v=!o&&e.jsx(A,{to:"/user/dashboard"}),c=localStorage.getItem("lang")||"",F=e.jsx(e.Fragment,{children:e.jsx(U,{err:N})}),T=this.props.location.state?e.jsx(u,{time:5e3,message:this.props.location.state.message}):null,W=e.jsx(u,{message:k});n||(n=[]);const w=n.map(s=>$(s,{created_at:L(s.created_at),post_category:s.post_category.name[c],title:s.title[c],body:O(s.body[c]),photo:s.photo&&e.jsxs("div",{className:"d-flex",children:[e.jsx("span",{children:i}),e.jsx("span",{className:"ml-auto",children:e.jsx(G,{title:`${a.post_photo}: ${s.title[c]}`,content:e.jsx("img",{src:s.photo,className:"w-100"}),children:e.jsx(d,{icon:g,className:"text-green mr-2",fixedWidth:!0})})})]}),action:e.jsxs("div",{className:"text-center",children:[e.jsx(j,{to:`/user/posts/${s.id}`,className:"mx-1",children:e.jsx(d,{icon:g,className:"text-green",fixedWidth:!0})}),JSON.parse((o==null?void 0:o.permissions)||"[]").includes("u")&&e.jsx(j,{to:`/user/posts/${s.id}/edit`,className:"mx-1",children:e.jsx(d,{icon:I,className:"text-brokenblue",fixedWidth:!0})}),JSON.parse((o==null?void 0:o.permissions)||"[]").includes("d")&&e.jsx("span",{className:"mx-1",children:e.jsx(C,{deleteAction:()=>this.props.delete(s.id),children:e.jsx(d,{icon:J,className:"text-red",fixedWidth:!0})})})]})})),D=e.jsx(e.Fragment,{children:e.jsx(R,{children:e.jsx(M,{array:w,loading:b,data:JSON.stringify(n),get:this.props.get,total:_,bordered:!0,add:y,link:"/user/posts/add",icon:f,title:m,className:"shadow-sm",fields:[{name:a.title,key:"title"},{name:a.post_category,key:"post_category"},{name:a.body,key:"body"},{name:a.photo,key:"photo"},{name:a.slug,key:"slug"},{name:a.is_active,key:"is_active"},{name:t,key:"action",fixed:!0}]})})});return e.jsxs(e.Fragment,{children:[e.jsxs(q,{children:[e.jsx(B,{main:m,icon:f}),e.jsx(V,{children:l}),e.jsx(z,{children:m})]}),e.jsxs("div",{children:[v,F,T,W,D]})]})}}const Y=r=>({...r}),Z=r=>({get:(t,i,l)=>r(H(t,i,l)),delete:t=>r(K(t)),reset:()=>r(Q())}),me=E(Y,Z)(X);export{me as default};
