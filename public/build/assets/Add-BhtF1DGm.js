var U=Object.defineProperty;var R=(r,o,s)=>o in r?U(r,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[o]=s;var m=(r,o,s)=>R(r,typeof o!="symbol"?o+"":o,s);import{c as _,r as I,j as e,C as S,R as y,aU as k,aZ as F,a_ as T,F as w,f as H,q as z,a as q}from"./index-BncDn27B.js";import{F as B}from"./FormGroup-CjRq5iBt.js";import{B as D,S as E,a as L}from"./Subtitle-EIBA-Hk5.js";import{e as W}from"./Error-CC8F97pB.js";import{F as x,a as $}from"./Input-BldVOD2V.js";import{S as M}from"./index-3VnVM_zO.js";import{T as P}from"./index-C0jNRMwo.js";import{F as G}from"./Feedback-C0SvNv4r.js";import{a as V,p as Z,b as J,r as K}from"./admins-BEmY--BK.js";import"./app-BShz7gyO.js";import"./BreadcrumbItem-BLbML1-v.js";import"./WithTooltip-yJJWpatI.js";const A={name:"",phone:"",photo:null,email:"",password:"",password_confirmation:"",role_id:"",add:!1};class O extends I.Component{constructor(){super(...arguments);m(this,"state",{...A});m(this,"saveHandler",s=>{var t,i,n,a,d;s.preventDefault(),this.props.edit?(n=(i=this.props).patch)==null||n.call(i,(t=this.props.match)==null?void 0:t.params.id,s.target):(d=(a=this.props).post)==null||d.call(a,s.target)});m(this,"saveAddHandler",()=>this.setState({add:!0},()=>{var s,t;return(t=(s=this.props).post)==null?void 0:t.call(s,document.querySelector("form"))}));m(this,"inputChangeHandler",s=>{const{name:t,value:i,files:n}=s.target;n&&this.readURL(s.target),this.setState({[t]:n?n[0]:i})});m(this,"readURL",s=>{if(s.files&&s.files[0]){const t=s.files[0],i=new FileReader;i.onload=function(n){var d;const a=document.getElementById(`embed-${s.name}`);if(a){a.style.backgroundImage=`url('${(d=n.target)==null?void 0:d.result}')`,a.style.backgroundSize="cover";const p=a.querySelector(".file-selected");p&&(p.innerHTML=t.name)}},i.readAsDataURL(t)}});m(this,"fileUpload",()=>{var s;return(s=document.getElementById("photo"))==null?void 0:s.click()})}componentDidMount(){var s,t,i,n,a;(t=(s=this.props).reset)==null||t.call(s),this.props.edit&&((a=(n=this.props).get)==null||a.call(n,(i=this.props.match)==null?void 0:i.params.id))}componentDidUpdate(s){var t,i,n,a,d,p,u,h,f,g,l,j,b,v;if(!((i=(t=s.backend)==null?void 0:t.admins)!=null&&i.message)&&((a=(n=this.props.backend)==null?void 0:n.admins)!=null&&a.message)&&this.props.backend.admins.message.type==="success"&&!this.props.edit&&(this.state.add?this.setState({...A}):(d=this.props.history)==null||d.push({pathname:"/admin/admins",state:{message:this.props.backend.admins.message}})),!((u=(p=s.backend)==null?void 0:p.admins)!=null&&u.admin)&&((f=(h=this.props.backend)==null?void 0:h.admins)!=null&&f.admin)){const{backend:{admins:{admin:c}}}=this.props;this.setState({...c})}if(this.props.edit&&!((l=(g=s.backend)==null?void 0:g.admins)!=null&&l.message)&&((b=(j=this.props.backend)==null?void 0:j.admins)!=null&&b.message)&&this.props.backend.admins.message.type==="success"){if(!((v=this.props.backend.admins.admin)!=null&&v.photo))return;const{photo:c}=this.props.backend.admins.admin;this.setState({photo:c})}}componentWillUnmount(){var s,t;(t=(s=this.props).reset)==null||t.call(s)}render(){var N;if(!this.props.content||!((N=this.props.backend)!=null&&N.admins))return null;let{content:{cms:{pages:{backend:{pages:{admins:{title:s,add:t,edit:i,index:n,form:a}}}}}},backend:{admins:{loading:d,error:p,message:u,admin:h}}}=this.props,{name:f,phone:g,photo:l,email:j,password:b,password_confirmation:v}=this.state,c,C=null;return d?c=e.jsx(S,{xs:12,children:e.jsx(q,{})}):(C=e.jsx(e.Fragment,{children:e.jsx(W,{err:p})}),c=e.jsx(e.Fragment,{children:e.jsxs(S,{xl:9,children:[e.jsx(G,{message:u}),this.props.edit&&e.jsx("input",{type:"hidden",name:"_method",defaultValue:"PATCH"}),e.jsx("div",{className:"shadow-lg rounded-8 bg-white px-4 px-sm-5 py-3 py-sm-4",children:e.jsxs(y,{className:"my-2 my-sm-3",children:[e.jsx("div",{className:"col-lg-9",children:e.jsxs(y,{children:[e.jsx(x,{type:"text",className:"col-md-6",icon:k,onChange:this.inputChangeHandler,value:f,name:"name",required:!0,placeholder:a.name}),e.jsx(x,{type:"tel",className:"col-md-6",addon:e.jsx("span",{className:"text-secondary text-small",children:"+237"}),onChange:this.inputChangeHandler,value:g,name:"phone",required:!0,placeholder:a.phone}),e.jsx(x,{type:"password",className:"col-md-6",icon:F,onChange:this.inputChangeHandler,value:b,name:"password",placeholder:a.password}),e.jsx(x,{type:"password",className:"col-md-6",icon:F,onChange:this.inputChangeHandler,value:v,name:"password_confirmation",placeholder:a.password_confirmation}),e.jsx(x,{type:"email",className:"col-md-6",icon:T,onChange:this.inputChangeHandler,value:j,name:"email",placeholder:a.email})]})}),e.jsx("div",{className:"col-lg-3",children:e.jsx(B,{children:e.jsx("div",{id:"embed-photo",className:"embed-responsive embed-responsive-1by1 bg-soft rounded-8 d-flex justify-content-center align-items-center position-relative",style:{cursor:"pointer",backgroundImage:l?`url("${l}")`:void 0,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover",overflow:"visible"},onClick:this.fileUpload,children:this.props.edit?l&&l!==(h==null?void 0:h.photo)&&e.jsxs("div",{className:"text-center text-green w-100",children:[e.jsx("div",{className:"position-absolute",style:{top:0,right:0,transform:"translate(50%,-50%)"},children:e.jsx(w,{icon:H,fixedWidth:!0,size:"2x"})}),e.jsx("div",{className:"position-absolute file-selected text-truncate w-100 pt-3",style:{top:"100%",left:0}})]}):l?e.jsxs("div",{className:"text-center text-green w-100",children:[e.jsx("div",{className:"position-absolute",style:{top:0,right:0,transform:"translate(50%,-50%)"},children:e.jsx(w,{icon:H,fixedWidth:!0,size:"2x"})}),e.jsx("div",{className:"position-absolute file-selected text-truncate w-100 pt-3",style:{top:"100%",left:0}})]}):e.jsxs("div",{className:"text-center text-light w-100 overflow-hidden px-3",children:[e.jsx("div",{children:e.jsx(w,{icon:z,fixedWidth:!0,size:"4x"})}),e.jsx("div",{className:"mt-3 mb-1 text-center text-12 text-truncate",children:a.upload}),e.jsx("div",{className:"text-center text-12 text-truncate",children:a.size})]})})})}),e.jsx(M,{edit:!!this.props.edit,saveAddHandler:this.saveAddHandler})]})})]})})),e.jsxs(e.Fragment,{children:[e.jsxs(P,{children:[e.jsx(D,{items:this.props.edit?[{to:"/admin/admins",content:n}]:void 0,main:this.props.edit?i:t,icon:k}),e.jsx(E,{children:s}),e.jsx(L,{children:this.props.edit?i:t})]}),e.jsxs("div",{children:[C,e.jsx(y,{children:e.jsxs($,{onSubmit:this.saveHandler,icon:k,title:this.props.edit?i:t,list:n,link:"/admin/admins",innerClassName:"row justify-content-center",children:[e.jsx("input",{type:"file",id:"photo",name:"photo",className:"d-none",onChange:this.inputChangeHandler,accept:".png,.jpg,.jpeg"}),c]})})]})]})}}const Q=r=>({...r}),X=r=>({get:o=>r(V(o)),post:o=>r(Z(o)),patch:(o,s)=>r(J(o,s)),reset:()=>r(K())}),me=_(Q,X)(O);export{me as default};
