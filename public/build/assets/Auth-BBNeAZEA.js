var _=Object.defineProperty;var w=(o,n,s)=>n in o?_(o,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[n]=s;var v=(o,n,s)=>w(o,typeof n!="symbol"?n+"":n,s);import{c as V,r as T,u as I,j as e,N as P,C as N,R as b,I as H,a as B}from"./index-BncDn27B.js";import{F as A}from"./FormGroup-CjRq5iBt.js";import{B as L,S as M,a as R}from"./Subtitle-EIBA-Hk5.js";import{e as z}from"./Error-CC8F97pB.js";import{a as E}from"./Input-BldVOD2V.js";import{b as J}from"./BetweenButton-CNQ28UJ2.js";import{T as U}from"./index-C0jNRMwo.js";import{F as W}from"./Feedback-C0SvNv4r.js";import{g as G,p as q,r as K}from"./cms-Dgxu_C9N.js";import{A as S}from"./Auth-QVvALckm.js";import{r as F}from"./types-DL2rpS-Q.js";import"./app-BShz7gyO.js";import"./BreadcrumbItem-BLbML1-v.js";import"./WithTooltip-yJJWpatI.js";const D="wrench",Q=({auth:o,language:n})=>{const[s,r]=T.useState(n.abbr+"-footer"),[t,c]=T.useState(o),p=a=>{const{value:i}=a.target;i!==s&&r(i)},g=Object.keys(o||{}).sort((a,i)=>a.localeCompare(i)).map(a=>{const i=`${n.abbr}-${a}`;return e.jsx("option",{className:"text-capitalize",value:i,children:a.split("_").join(" ")},i)}),l=`${n.abbr}[auth]`,d=S.admin,C=`${l}[admin]`,j=t==null?void 0:t.admin,h=["admin"],f=F(t,c)(d,C,j,h,[{regex:`${l}[admin][login][sign_in_to]`,action:()=>e.jsx(N,{xs:12,children:e.jsx("h4",{children:"Login"})})},{regex:`${l}[admin][verify][enter]`,action:()=>e.jsx(N,{xs:12,children:e.jsx("h4",{children:"Verify"})})}]),$=Object.keys(S).filter(a=>!["admin"].includes(a)).map(a=>{const i=S[a],u=`${l}[${a}]`,x=t==null?void 0:t[a],k=[a],m=F(t,c)(i,u,x,k),O=n.abbr+"-"+a;return e.jsx(b,{className:`pt-4 ${s===O?"":"d-none"}`,children:m},n.abbr+"-"+u)});return e.jsxs(b,{children:[e.jsx("div",{className:"col-md-6 col-xl-4 col-xxl-3",children:e.jsx(A,{children:e.jsx(H,{type:"select",name:"tab",onChange:p,className:"text-capitalize",value:s,children:g})})}),e.jsxs("div",{className:"col-12",children:[e.jsx(b,{className:`pt-4 ${s===n.abbr+"-admin"?"":"d-none"}`,children:f}),$]})]},"Languages-"+n.abbr)};class X extends T.Component{constructor(){super(...arguments);v(this,"state",{abbr:"fr"});v(this,"submitHandler",async s=>{var r,t;s.preventDefault(),await((t=(r=this.props).patch)==null?void 0:t.call(r,s.target))});v(this,"inputChangeHandler",s=>{const{name:r,value:t,files:c}=s.target;this.setState({[r]:c?c[0]:t})})}static getDerivedStateFromProps(s,r){var t,c;if((c=(t=s.backend)==null?void 0:t.cms)!=null&&c.cms&&r.app_name===""){const{backend:{cms:{cms:{auth:p}}}}=s;return I(r,{...p})}return r}async componentDidMount(){var s,r,t,c;(r=(s=this.props).reset)==null||r.call(s),(c=(t=this.props).get)==null||c.call(t)}componentWillUnmount(){var s,r;(r=(s=this.props).reset)==null||r.call(s)}render(){var a,i,u;if(!((a=this.props.content)!=null&&a.cms)||!((i=this.props.backend)!=null&&i.cms)||!((u=this.props.auth)!=null&&u.data))return null;let{content:{cms:{pages:{components:{form:{save:s}},backend:{pages:{cms:{title:r,auth:t}}}}}},backend:{cms:{loading:c,error:p,message:g,cms:l,languages:d}},auth:{data:{role:{features:C}}}}=this.props;const{abbr:j}=this.state;let h=null,f=null;const y=C.find(x=>x.prefix==="cms"),$=!(y&&JSON.parse(y.permissions).includes("u"))&&e.jsx(P,{to:"/user/dashboard"});if(c)h=e.jsx(N,{xs:12,children:e.jsx(B,{})});else{f=e.jsx(e.Fragment,{children:e.jsx(z,{err:p})}),d||(d=[]);const x=d.map(m=>e.jsx("option",{value:m.abbr,children:m.name},Math.random()+JSON.stringify(m))),k=d.map(m=>e.jsx("div",{className:m.abbr===j?"":"d-none",children:e.jsx(Q,{language:m,auth:l==null?void 0:l.pages[m.abbr].auth})},Math.random()));h=e.jsxs(N,{lg:9,children:[e.jsx(W,{message:g}),e.jsxs(b,{children:[e.jsx("input",{type:"hidden",name:"_method",defaultValue:"PATCH"}),e.jsx("div",{className:"col-md-6 col-xl-4 col-xxl-3",children:e.jsx(A,{children:e.jsx(H,{type:"select",name:"abbr",onChange:this.inputChangeHandler,value:j,children:x})})}),e.jsx("div",{className:"col-12",children:k}),e.jsx("div",{className:"col-12",children:e.jsx(J,{color:"green",icon:"save",children:s})})]})]})}return e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(L,{main:t,icon:D}),e.jsx(M,{children:r}),e.jsx(R,{children:t})]}),e.jsxs("div",{className:"p-4 pb-0",children:[$,f,e.jsx(b,{children:e.jsx(E,{onSubmit:this.submitHandler,icon:D,title:t,link:"/admin/cms",innerClassName:"row justify-content-center",children:h})})]})]})}}const Y=o=>({...o}),Z=o=>({get:()=>o(G()),patch:n=>o(q("auth",n)),reset:()=>o(K())}),xe=V(Y,Z)(X);export{xe as default};
