var q=Object.defineProperty;var B=(r,o,s)=>o in r?q(r,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[o]=s;var m=(r,o,s)=>B(r,typeof o!="symbol"?o+"":o,s);import{c as O,r as H,j as e,N as R,C as w,R as _,I as E,a as J}from"./index-BncDn27B.js";import{F as U}from"./FormGroup-CjRq5iBt.js";import{B as W,S as $,a as G}from"./Subtitle-EIBA-Hk5.js";import{e as M}from"./Error-CC8F97pB.js";import{F as A,a as V}from"./Input-BldVOD2V.js";import{S as z}from"./index-3VnVM_zO.js";import{T as K}from"./index-C0jNRMwo.js";import{F as L}from"./Feedback-C0SvNv4r.js";import{a as Q,b as X,p as Y,c as Z,r as ee}from"./post-categories-D8n_eiXp.js";import"./app-BShz7gyO.js";import"./BreadcrumbItem-BLbML1-v.js";import"./WithTooltip-yJJWpatI.js";const C="th-list",P={name:{},is_active:"1",translate:"",add:!1};class se extends H.Component{constructor(){super(...arguments);m(this,"state",{...P});m(this,"saveHandler",s=>{var t,i,a,p,c;s.preventDefault(),this.props.edit?(a=(i=this.props).patch)==null||a.call(i,(t=this.props.match)==null?void 0:t.params.id,s.target):(c=(p=this.props).post)==null||c.call(p,s.target)});m(this,"saveAddHandler",()=>this.setState({add:!0},()=>{var s,t;return(t=(s=this.props).post)==null?void 0:t.call(s,document.querySelector("form"))}));m(this,"inputChangeHandler",s=>{const{name:t,value:i,files:a}=s.target;if(t.includes("[")){const{translate:p}=this.state,c=t.split("[")[0],d=this.state[c];return d&&(d[p]=i),this.setState({[c]:d})}this.setState({[t]:a?a[0]:i})})}componentDidMount(){var s,t,i,a;(t=(s=this.props).reset)==null||t.call(s),this.props.edit&&this.props.match&&((a=(i=this.props).show)==null||a.call(i,this.props.match.params.id)),this.setState({translate:"fr"})}componentDidUpdate(s){var t,i,a,p,c,d,l,h,g,u,x,j,f;if(!((i=(t=s.backend)==null?void 0:t.post_categories)!=null&&i.message)&&((p=(a=this.props.backend)==null?void 0:a.post_categories)!=null&&p.message)&&this.props.backend.post_categories.message.type==="success"&&!this.props.edit&&(this.state.add?this.setState({...P,translate:"fr"}):(c=this.props.history)==null||c.push({pathname:"/user/post-categories",state:{message:this.props.backend.post_categories.message}})),!((l=(d=s.backend)==null?void 0:d.post_categories)!=null&&l.post_category)&&((g=(h=this.props.backend)==null?void 0:h.post_categories)!=null&&g.post_category)||this.props.edit&&!((x=(u=s.backend)==null?void 0:u.post_categories)!=null&&x.message)&&((f=(j=this.props.backend)==null?void 0:j.post_categories)!=null&&f.message)&&this.props.backend.post_categories.message.type==="success"){const{backend:{post_categories:{post_category:b}}}=this.props;this.setState({...b})}}componentWillUnmount(){var s,t;(t=(s=this.props).reset)==null||t.call(s)}render(){var k,N,F;if(!((k=this.props.content)!=null&&k.cms)||!((N=this.props.backend)!=null&&N.post_categories)||!((F=this.props.auth)!=null&&F.data))return null;let{content:{cms:{pages:{components:{form:{active:s,inactive:t}},backend:{pages:{post_categories:{title:i,add:a,edit:p,index:c,form:d}}}}},languages:l},backend:{post_categories:{loading:h,error:g,message:u}},auth:{data:{role:{features:x}}}}=this.props,{name:j,is_active:f,translate:b}=this.state,v,y=null;const S=x.find(n=>n.prefix==="post-categories"),T=!(S&&JSON.parse(S.permissions).includes(this.props.edit?"u":"c"))&&e.jsx(R,{to:"/user/dashboard"}),D=l==null?void 0:l.sort((n,I)=>n.name.localeCompare(I.name)).map(n=>e.jsx("option",{value:n.abbr,children:n.name},JSON.stringify(n)));return h?v=e.jsx(w,{xs:12,children:e.jsx(J,{})}):(y=e.jsx(e.Fragment,{children:e.jsx(M,{err:g})}),v=e.jsx(e.Fragment,{children:e.jsxs(w,{xl:9,children:[e.jsx(L,{message:u}),this.props.edit&&e.jsx("input",{type:"hidden",name:"_method",defaultValue:"PATCH"}),e.jsx("div",{className:"shadow-lg rounded-8 bg-white px-4 px-sm-5 py-3 py-sm-4",children:e.jsxs(_,{className:"my-2 my-sm-3",children:[e.jsx("div",{className:"col-lg-9",children:e.jsx("div",{className:"row",children:l==null?void 0:l.map(n=>e.jsx(H.Fragment,{children:e.jsx(A,{type:"text",id:"name-"+n.abbr,className:"col-md-6"+(n.abbr===b?"":" d-none"),icon:C,onChange:this.inputChangeHandler,value:j[n.abbr],name:"name["+n.abbr+"]",required:!0,placeholder:d.name})},"language-"+n.abbr))})}),e.jsx("div",{className:"col-lg-3",children:e.jsx(U,{children:e.jsx(E,{type:"select",name:"translate",onChange:this.inputChangeHandler,value:b,children:D})})}),e.jsx("div",{className:"col-12 mb-3",children:e.jsx("hr",{})}),e.jsx("div",{className:"col-lg-9",children:e.jsx(_,{children:e.jsxs(A,{type:"select",className:"col-md-6",icon:"pencil-alt",onChange:this.inputChangeHandler,value:f,name:"is_active",required:!0,children:[e.jsx("option",{children:d.select_status}),e.jsx("option",{value:1,children:s}),e.jsx("option",{value:0,children:t})]})})}),e.jsx(z,{edit:!!this.props.edit,saveAddHandler:this.saveAddHandler})]})})]})})),e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsx(W,{items:this.props.edit?[{to:"/user/post-categories",content:c}]:void 0,main:this.props.edit?p:a,icon:C}),e.jsx($,{children:i}),e.jsx(G,{children:this.props.edit?p:a})]}),e.jsxs("div",{children:[T,y,e.jsx(_,{children:e.jsx(V,{onSubmit:this.saveHandler,icon:C,title:this.props.edit?p:a,list:c,link:"/user/post-categories",innerClassName:"row justify-content-center",children:v})})]})]})}}const te=r=>({...r}),ae=r=>({show:o=>r(Q(o)),info:()=>r(X()),post:o=>r(Y(o)),patch:(o,s)=>r(Z(o,s)),reset:()=>r(ee())}),je=O(te,ae)(se);export{je as default};
