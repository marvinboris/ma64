import{c as _,r as $,j as e,u as E,m as L,F as c,i as h,L as u,k as O,n as U,R as J,N as R}from"./index-BncDn27B.js";import{B as A,S as B,a as I}from"./Subtitle-EIBA-Hk5.js";import{D as P,L as V}from"./Delete-DN_4O9m9.js";import{e as C}from"./Error-CC8F97pB.js";import{F as j}from"./Feedback-C0SvNv4r.js";import{T as M}from"./index-C0jNRMwo.js";import{V as q}from"./View-DYaRmNR8.js";import{g as z,d as G,r as H}from"./users-DD1ZIDYJ.js";import"./app-BShz7gyO.js";import"./BreadcrumbItem-BLbML1-v.js";import"./Table-Cy8UlfKH.js";const f="user";class K extends $.Component{componentDidMount(){var t,o;(o=(t=this.props).get)==null||o.call(t)}componentWillUnmount(){this.props.reset()}render(){var l,p,x;if(!((l=this.props.content)!=null&&l.cms)||!((p=this.props.backend)!=null&&p.users)||!((x=this.props.auth)!=null&&x.data))return null;let{content:{cms:{pages:{components:{list:{action:t,see:o}},backend:{pages:{users:{title:d,add:g,index:m,form:n}}}}}},backend:{users:{loading:N,error:k,message:b,users:i,total:y}},auth:{data:{role:{features:F}}}}=this.props;const a=F.find(s=>s.prefix==="users"),S=!a&&e.jsx(R,{to:"/user/dashboard"}),T=e.jsx(e.Fragment,{children:e.jsx(C,{err:k})}),W=this.props.location.state?e.jsx(j,{time:5e3,message:this.props.location.state.message}):null,v=e.jsx(j,{message:b});i||(i=[]);const w=i.map(s=>E(s,{created_at:L(s.created_at),photo:s.photo&&e.jsxs("div",{className:"d-flex",children:[e.jsx("span",{children:o}),e.jsx("span",{className:"ml-auto",children:e.jsx(q,{title:`${n.user_photo}: ${s.name}`,content:e.jsx("img",{src:s.photo,className:"w-100"}),children:e.jsx(c,{icon:h,className:"text-green mr-2",fixedWidth:!0})})})]}),action:e.jsxs("div",{className:"text-center",children:[e.jsx(u,{to:`/user/users/${s.id}`,className:"mx-1",children:e.jsx(c,{icon:h,className:"text-green",fixedWidth:!0})}),JSON.parse((a==null?void 0:a.permissions)||"[]").includes("u")&&e.jsx(u,{to:`/user/users/${s.id}/edit`,className:"mx-1",children:e.jsx(c,{icon:O,className:"text-brokenblue",fixedWidth:!0})}),JSON.parse((a==null?void 0:a.permissions)||"[]").includes("d")&&e.jsx("span",{className:"mx-1",children:e.jsx(P,{deleteAction:()=>this.props.delete(s.id),children:e.jsx(c,{icon:U,className:"text-red",fixedWidth:!0})})})]})})),D=e.jsx(e.Fragment,{children:e.jsx(J,{children:e.jsx(V,{array:w,loading:N,data:JSON.stringify(i),get:this.props.get,total:y,bordered:!0,add:g,link:"/user/users/add",icon:f,title:m,className:"shadow-sm",fields:[{name:n.full_name,key:"name"},{name:n.email,key:"email"},{name:n.phone,key:"phone"},{name:n.role,key:"role"},{name:n.photo,key:"photo"},{name:t,key:"action",fixed:!0}]})})});return e.jsxs(e.Fragment,{children:[e.jsxs(M,{children:[e.jsx(A,{main:m,icon:f}),e.jsx(B,{children:d}),e.jsx(I,{children:m})]}),e.jsxs("div",{children:[S,T,W,v,D]})]})}}const Q=r=>({...r}),X=r=>({get:(t,o,d)=>r(z(t,o,d)),delete:t=>r(G(t)),reset:()=>r(H())}),de=_(Q,X)(K);export{de as default};
