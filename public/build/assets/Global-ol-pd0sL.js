var H=Object.defineProperty;var T=(n,o,s)=>o in n?H(n,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[o]=s;var i=(n,o,s)=>T(n,typeof o!="symbol"?o+"":o,s);import{c as B,r as D,u as E,j as e,N as I,C as m,R as f,F as P,f as R,a as U}from"./index-BncDn27B.js";import{B as W,S as $,a as q}from"./Subtitle-EIBA-Hk5.js";import{e as z}from"./Error-CC8F97pB.js";import{F as b,a as A}from"./Input-BldVOD2V.js";import{b as G}from"./BetweenButton-CNQ28UJ2.js";import{T as O}from"./index-C0jNRMwo.js";import{F as J}from"./Feedback-C0SvNv4r.js";import{g as M,p as V,r as K}from"./cms-Dgxu_C9N.js";import"./app-BShz7gyO.js";import"./BreadcrumbItem-BLbML1-v.js";import"./FormGroup-CjRq5iBt.js";import"./WithTooltip-yJJWpatI.js";const C="wrench";class L extends D.Component{constructor(){super(...arguments);i(this,"state",{logo:null,app_name:"",company_name:""});i(this,"submitHandler",async s=>{var t,a;s.preventDefault(),await((a=(t=this.props).patch)==null?void 0:a.call(t,s.target))});i(this,"inputChangeHandler",s=>{const{name:t,value:a,files:r}=s.target;this.setState({[t]:r?r[0]:a})});i(this,"fileUpload",()=>{var s;return(s=document.getElementById("logo"))==null?void 0:s.click()})}static getDerivedStateFromProps(s,t){var a,r;if((r=(a=s.backend)==null?void 0:a.cms)!=null&&r.cms&&t.app_name===""){const{backend:{cms:{cms:{global:l}}}}=s;return E(t,{...l})}return t}async componentDidMount(){var s,t,a,r;(t=(s=this.props).reset)==null||t.call(s),(r=(a=this.props).get)==null||r.call(a)}componentWillUnmount(){var s,t;(t=(s=this.props).reset)==null||t.call(s)}render(){var g,x,j;if(!((g=this.props.content)!=null&&g.cms)||!((x=this.props.backend)!=null&&x.cms)||!((j=this.props.auth)!=null&&j.data))return null;let{content:{cms:{pages:{components:{form:{save:s,selected_file:t}},backend:{pages:{cms:{title:a,global:r,form:l}}}}}},backend:{cms:{loading:v,error:y,message:k,cms:p}},auth:{data:{role:{features:N}}}}=this.props;const{logo:c,app_name:_,company_name:F}=this.state;let d=null,u=null;const h=N.find(w=>w.prefix==="cms"),S=!(h&&JSON.parse(h.permissions).includes("u"))&&e.jsx(I,{to:"/user/dashboard"});return v?d=e.jsx(m,{xs:12,children:e.jsx(U,{})}):(u=e.jsx(e.Fragment,{children:e.jsx(z,{err:y})}),d=e.jsx(m,{lg:9,children:e.jsxs(f,{children:[e.jsxs(m,{lg:8,children:[e.jsx(J,{message:k}),e.jsxs(f,{children:[e.jsx("input",{type:"hidden",name:"_method",defaultValue:"PATCH"}),e.jsx(b,{type:"text",className:"col-md-6",icon:"signature",onChange:this.inputChangeHandler,value:_,name:"app_name",required:!0,placeholder:l.app_name}),e.jsx(b,{type:"text",className:"col-md-6",icon:"signature",onChange:this.inputChangeHandler,value:F,name:"company_name",required:!0,placeholder:l.company_name}),e.jsx("input",{type:"file",id:"logo",name:"logo",className:"d-none",onChange:this.inputChangeHandler,accept:".png,.jpg,.jpeg"}),e.jsx("div",{className:"col-12",children:e.jsx(G,{color:"green",icon:"save",children:s})})]})]}),e.jsx(m,{lg:4,children:e.jsx("div",{className:"embed-responsive embed-responsive-1by1 bg-soft border border-light d-flex justify-content-center align-items-center w-60 mx-auto",style:{cursor:"pointer",background:c?`url("${c}") no-repeat center`:void 0,backgroundSize:"contain"},onClick:this.fileUpload,children:c&&c!==(p==null?void 0:p.global.logo)&&e.jsxs("div",{className:"text-center text-green",children:[e.jsx("div",{children:e.jsx(P,{icon:R,fixedWidth:!0,size:"5x"})}),e.jsx("div",{className:"mt-3",children:t})]})})})]})})),e.jsxs(e.Fragment,{children:[e.jsxs(O,{children:[e.jsx(W,{main:r,icon:C}),e.jsx($,{children:a}),e.jsx(q,{children:r})]}),e.jsxs("div",{className:"p-4 pb-0",children:[S,u,e.jsx(A,{onSubmit:this.submitHandler,icon:C,title:r,link:"/admin/cms",innerClassName:"row justify-content-center",children:d})]})]})}}const Q=n=>({...n}),X=n=>({get:()=>n(M()),patch:o=>n(V("global",o)),reset:()=>n(K())}),pe=B(Q,X)(L);export{pe as default};
