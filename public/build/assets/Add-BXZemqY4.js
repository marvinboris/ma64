var _=Object.defineProperty;var M=(o,r,s)=>r in o?_(o,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[r]=s;var h=(o,r,s)=>M(o,typeof r!="symbol"?r+"":r,s);import{c as q,r as D,j as e,N as B,C as y,R as j,a as R}from"./index-BncDn27B.js";import{B as E,S as P,a as U}from"./Subtitle-EIBA-Hk5.js";import{e as W}from"./Error-CC8F97pB.js";import{F as f,a as $}from"./Input-BldVOD2V.js";import{S as I}from"./index-3VnVM_zO.js";import{T as J}from"./index-C0jNRMwo.js";import{F as O}from"./Feedback-C0SvNv4r.js";import{a as V,p as z,b as G,r as K}from"./methods-CLJ3OfNT.js";import"./app-BShz7gyO.js";import"./BreadcrumbItem-BLbML1-v.js";import"./FormGroup-CjRq5iBt.js";import"./WithTooltip-yJJWpatI.js";const g="th-list",H={name:"",text:"",is_active:"1",add:!1};class L extends D.Component{constructor(){super(...arguments);h(this,"state",{...H});h(this,"saveHandler",s=>{var t,i,a,n,d;s.preventDefault(),this.props.edit?(a=(i=this.props).patch)==null||a.call(i,(t=this.props.match)==null?void 0:t.params.id,s.target):(d=(n=this.props).post)==null||d.call(n,s.target)});h(this,"saveAddHandler",()=>this.setState({add:!0},()=>{var s,t;return(t=(s=this.props).post)==null?void 0:t.call(s,document.querySelector("form"))}));h(this,"inputChangeHandler",s=>{const{name:t,value:i,files:a}=s.target;this.setState({[t]:a?a[0]:i})})}componentDidMount(){var s,t,i,a;(t=(s=this.props).reset)==null||t.call(s),this.props.edit&&this.props.match&&((a=(i=this.props).show)==null||a.call(i,this.props.match.params.id))}componentDidUpdate(s){var t,i,a,n,d,p,m,l,c;if(!((i=(t=s.backend)==null?void 0:t.methods)!=null&&i.message)&&((n=(a=this.props.backend)==null?void 0:a.methods)!=null&&n.message)&&this.props.backend.methods.message.type==="success"&&!this.props.edit&&(this.state.add?this.setState({...H}):(d=this.props.history)==null||d.push({pathname:"/user/methods",state:{message:this.props.backend.methods.message}})),!((m=(p=s.backend)==null?void 0:p.methods)!=null&&m.method)&&((c=(l=this.props.backend)==null?void 0:l.methods)!=null&&c.method)){const{backend:{methods:{method:u}}}=this.props;this.setState({...u})}}componentWillUnmount(){var s,t;(t=(s=this.props).reset)==null||t.call(s)}render(){var S,C,k;if(!((S=this.props.content)!=null&&S.cms)||!((C=this.props.backend)!=null&&C.methods)||!((k=this.props.auth)!=null&&k.data))return null;let{content:{cms:{pages:{components:{form:{active:s,inactive:t}},backend:{pages:{methods:{title:i,add:a,edit:n,index:d,form:p}}}}}},backend:{methods:{loading:m,error:l,message:c}},auth:{data:{role:{features:u}}}}=this.props,{name:N,text:F,is_active:w}=this.state,x=null,v=null;const b=u.find(T=>T.prefix==="methods"),A=!(b&&JSON.parse(b.permissions).includes(this.props.edit?"u":"c"))&&e.jsx(B,{to:"/user/dashboard"});return m?x=e.jsx(y,{xs:12,children:e.jsx(R,{})}):(v=e.jsx(e.Fragment,{children:e.jsx(W,{err:l})}),x=e.jsx(e.Fragment,{children:e.jsxs(y,{xl:9,children:[e.jsx(O,{message:c}),this.props.edit&&e.jsx("input",{type:"hidden",name:"_method",defaultValue:"PATCH"}),e.jsx("div",{className:"shadow-lg rounded-8 bg-white px-4 px-sm-5 py-3 py-sm-4",children:e.jsxs(j,{className:"my-2 my-sm-3",children:[e.jsx("div",{className:"col-lg-9",children:e.jsxs(j,{children:[e.jsx(f,{type:"text",className:"col-md-6",icon:g,onChange:this.inputChangeHandler,value:N,name:"name",required:!0,placeholder:p.name}),e.jsx(f,{type:"text",className:"col-md-6",icon:"paragraph",onChange:this.inputChangeHandler,value:F,name:"text",required:!0,placeholder:p.text}),e.jsxs(f,{type:"select",className:"col-md-6",icon:"pencil-alt",onChange:this.inputChangeHandler,value:w,name:"is_active",required:!0,children:[e.jsx("option",{value:"",children:p.select_status}),e.jsx("option",{value:1,children:s}),e.jsx("option",{value:0,children:t})]})]})}),e.jsx(I,{edit:!!this.props.edit,saveAddHandler:this.saveAddHandler})]})})]})})),e.jsxs(e.Fragment,{children:[e.jsxs(J,{children:[e.jsx(E,{items:this.props.edit?[{to:"/user/methods",content:d}]:void 0,main:this.props.edit?n:a,icon:g}),e.jsx(P,{children:i}),e.jsx(U,{children:this.props.edit?n:a})]}),e.jsxs("div",{children:[A,v,e.jsx(j,{children:e.jsx($,{onSubmit:this.saveHandler,icon:g,title:this.props.edit?n:a,list:d,link:"/user/methods",innerClassName:"row justify-content-center",children:x})})]})]})}}const Q=o=>({...o}),X=o=>({show:r=>o(V(r)),post:r=>o(z(r)),patch:(r,s)=>o(G(r,s)),reset:()=>o(K())}),me=q(Q,X)(L);export{me as default};
