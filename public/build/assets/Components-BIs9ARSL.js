var E=Object.defineProperty;var H=(a,n,t)=>n in a?E(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t;var l=(a,n,t)=>H(a,typeof n!="symbol"?n+"":n,t);import{c as M,r as k,u as O,j as s,b1 as $,R as u,a$ as T,C as f,b2 as D,p as V,a as R}from"./index-BncDn27B.js";import{N as w,T as S,a as y}from"./TabPane-Dffaj7Z7.js";import{B as _,S as A,a as L}from"./Subtitle-EIBA-Hk5.js";import{e as U}from"./Error-CC8F97pB.js";import{a as W}from"./Input-BldVOD2V.js";import{b as z}from"./BetweenButton-CNQ28UJ2.js";import{F as q}from"./Feedback-C0SvNv4r.js";import{g as G,p as J,r as K}from"./cms-Dgxu_C9N.js";import{C as F}from"./Components-DHOrEZRE.js";import{r as I}from"./types-DL2rpS-Q.js";import"./app-BShz7gyO.js";import"./BreadcrumbItem-BLbML1-v.js";import"./FormGroup-CjRq5iBt.js";import"./WithTooltip-yJJWpatI.js";const Q=({components:a,language:n})=>{const[t,r]=k.useState(n.abbr+"-form"),[e,o]=k.useState(a),p=h=>{t!==h&&r(h)},v=Object.keys(a||{}).map(h=>{const g=`${n.abbr}-${h}`;return s.jsx($,{children:s.jsx(w,{onClick:()=>p(g),className:t===g?"active":"",children:s.jsx("span",{className:"text-capitalize",children:h})})},g)}),c=`${n.abbr}[components]`,m=F.form,b=`${c}[form]`,d=e==null?void 0:e.form,x=["form"],j=I(e,o)(m,b,d,x),N=F.list,C=`${c}[list]`,i=e==null?void 0:e.list,P=["list"],B=I(e,o)(N,C,i,P);return s.jsxs(s.Fragment,{children:[s.jsx(D,{tabs:!0,pills:!0,children:v}),s.jsxs(y,{activeTab:t,children:[s.jsx(S,{tabId:n.abbr+"-form",className:"pt-4",children:s.jsx(u,{children:j})}),s.jsx(S,{tabId:n.abbr+"-list",className:"pt-4",children:s.jsx(u,{children:B})})]})]})};class X extends k.Component{constructor(){super(...arguments);l(this,"state",{activeTab:"fr"});l(this,"submitHandler",async t=>{var r,e;t.preventDefault(),await((e=(r=this.props).patch)==null?void 0:e.call(r,t.target))});l(this,"inputChangeHandler",t=>{const{name:r,value:e,files:o}=t.target;this.setState({[r]:o?o[0]:e})});l(this,"fileUpload",()=>{var t;return(t=document.getElementById("logo"))==null?void 0:t.click()});l(this,"toggle",t=>{this.state.activeTab!==t&&this.setState({activeTab:t})})}static getDerivedStateFromProps(t,r){var e,o;if((o=(e=t.backend)==null?void 0:e.cms)!=null&&o.cms&&r.app_name===""){const{backend:{cms:{cms:{components:p}}}}=t;return O(r,{...p})}return r}async componentDidMount(){var t,r,e,o;(r=(t=this.props).reset)==null||r.call(t),(o=(e=this.props).get)==null||o.call(e)}componentWillUnmount(){var t,r;(r=(t=this.props).reset)==null||r.call(t)}render(){var j;if(!this.props.content||!((j=this.props.backend)!=null&&j.cms))return null;let{content:{cms:{pages:{components:{form:{save:t}},backend:{pages:{cms:{title:r,components:e}}}}}},backend:{cms:{loading:o,error:p,message:v,cms:c,languages:m}}}=this.props;const{activeTab:b}=this.state;let d=null,x=null;if(o)d=s.jsx(f,{xs:12,children:s.jsx(R,{})});else{x=s.jsx(s.Fragment,{children:s.jsx(U,{err:p})}),m||(m=[]);const N=m.map(i=>s.jsx($,{children:s.jsx(w,{onClick:()=>this.toggle(i.abbr),className:b===i.abbr?"active":void 0,children:i.name})},Math.random())),C=m.map(i=>s.jsx(S,{tabId:i.abbr,children:s.jsx(Q,{components:c==null?void 0:c.pages[i.abbr].components,language:i})},Math.random()));d=s.jsx(s.Fragment,{children:s.jsx(u,{children:s.jsx(W,{onSubmit:this.submitHandler,icon:T,title:e,link:"/admin/cms",innerClassName:"row",className:"shadow-sm",children:s.jsxs(f,{lg:12,children:[s.jsx(q,{message:v}),s.jsxs(u,{children:[s.jsx("input",{type:"hidden",name:"_method",defaultValue:"PATCH"}),s.jsx(f,{lg:2,children:s.jsx(D,{tabs:!0,vertical:!0,pills:!0,children:N})}),s.jsx(f,{lg:10,children:s.jsx(y,{activeTab:b,children:C})}),s.jsx("div",{className:"col-12",children:s.jsx(z,{color:"green",icon:V,children:t})})]})]})})})})}return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-soft py-4 pl-5 pr-4 position-relative",children:[s.jsx(_,{main:e,icon:T}),s.jsx(A,{user:!0,icon:T,children:r}),s.jsx(L,{user:!0,children:e})]}),s.jsxs("div",{className:"p-4 pb-0",children:[x,d]})]})}}const Y=a=>({...a}),Z=a=>({get:()=>a(G()),patch:n=>a(J("components",n)),reset:()=>a(K())}),xs=M(Y,Z)(X);export{xs as default};
