var B=Object.defineProperty;var F=(r,n,s)=>n in r?B(r,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[n]=s;var l=(r,n,s)=>F(r,typeof n!="symbol"?n+"":n,s);import{c as H,r as w,j as e,N as A,C as y,R as j,a as T}from"./index-BncDn27B.js";import{B as D,S as R,a as q}from"./Subtitle-EIBA-Hk5.js";import{e as E}from"./Error-CC8F97pB.js";import{F as I,a as U}from"./Input-BldVOD2V.js";import{S as W}from"./index-3VnVM_zO.js";import{T as _}from"./index-C0jNRMwo.js";import{F as $}from"./Feedback-C0SvNv4r.js";import{a as J,b as M,p as O,c as P,r as V}from"./brands-B_Kft5ON.js";import"./app-BShz7gyO.js";import"./BreadcrumbItem-BLbML1-v.js";import"./FormGroup-CjRq5iBt.js";import"./WithTooltip-yJJWpatI.js";const S="copyright",C={name:"",add:!1};class z extends w.Component{constructor(){super(...arguments);l(this,"state",{...C});l(this,"saveHandler",s=>{var t,a,i,d,o;s.preventDefault(),this.props.edit?(i=(a=this.props).patch)==null||i.call(a,(t=this.props.match)==null?void 0:t.params.id,s.target):(o=(d=this.props).post)==null||o.call(d,s.target)});l(this,"saveAddHandler",()=>this.setState({add:!0},()=>{var s,t;return(t=(s=this.props).post)==null?void 0:t.call(s,document.querySelector("form"))}));l(this,"inputChangeHandler",s=>{const{name:t,value:a,files:i}=s.target;if(t.includes("[")){const{translate:d}=this.state,o=t.split("[")[0],p=this.state[o];return p&&(p[d]=a),this.setState({[o]:p})}this.setState({[t]:i?i[0]:a})})}componentDidMount(){var s,t,a,i;(t=(s=this.props).reset)==null||t.call(s),this.props.edit&&this.props.match&&((i=(a=this.props).show)==null||i.call(a,this.props.match.params.id)),this.setState({translate:"fr"})}componentDidUpdate(s){var t,a,i,d,o,p,u,b,x,c,m,h,f;if(!((a=(t=s.backend)==null?void 0:t.brands)!=null&&a.message)&&((d=(i=this.props.backend)==null?void 0:i.brands)!=null&&d.message)&&this.props.backend.brands.message.type==="success"&&!this.props.edit&&(this.state.add?this.setState({...C,translate:"fr"}):(o=this.props.history)==null||o.push({pathname:"/user/brands",state:{message:this.props.backend.brands.message}})),!((u=(p=s.backend)==null?void 0:p.brands)!=null&&u.brand)&&((x=(b=this.props.backend)==null?void 0:b.brands)!=null&&x.brand)||this.props.edit&&!((m=(c=s.backend)==null?void 0:c.brands)!=null&&m.message)&&((f=(h=this.props.backend)==null?void 0:h.brands)!=null&&f.message)&&this.props.backend.brands.message.type==="success"){const{backend:{brands:{brand:g}}}=this.props;this.setState({...g})}}componentWillUnmount(){var s,t;(t=(s=this.props).reset)==null||t.call(s)}render(){var g,k,v;if(!((g=this.props.content)!=null&&g.cms)||!((k=this.props.backend)!=null&&k.brands)||!((v=this.props.auth)!=null&&v.data))return null;let{content:{cms:{pages:{backend:{pages:{brands:{title:s,add:t,edit:a,index:i,form:d}}}}}},backend:{brands:{loading:o,error:p,message:u}},auth:{data:{role:{features:b}}}}=this.props,{name:x}=this.state,c,m=null;const h=b.find(N=>N.prefix==="brands"),f=!(h&&JSON.parse(h.permissions).includes(this.props.edit?"u":"c"))&&e.jsx(A,{to:"/user/dashboard"});return o?c=e.jsx(y,{xs:12,children:e.jsx(T,{})}):(m=e.jsx(e.Fragment,{children:e.jsx(E,{err:p})}),c=e.jsx(e.Fragment,{children:e.jsxs(y,{xl:9,children:[e.jsx($,{message:u}),this.props.edit&&e.jsx("input",{type:"hidden",name:"_method",defaultValue:"PATCH"}),e.jsx("div",{className:"shadow-lg rounded-8 bg-white px-4 px-sm-5 py-3 py-sm-4",children:e.jsxs(j,{className:"my-2 my-sm-3",children:[e.jsx("div",{className:"col-lg-9",children:e.jsx(j,{children:e.jsx(I,{type:"text",id:"name",className:"col-md-6",icon:S,onChange:this.inputChangeHandler,value:x,name:"name",required:!0,placeholder:d.name})})}),e.jsx(W,{edit:!!this.props.edit,saveAddHandler:this.saveAddHandler})]})})]})})),e.jsxs(e.Fragment,{children:[e.jsxs(_,{children:[e.jsx(D,{items:this.props.edit?[{to:"/user/brands",content:i}]:void 0,main:this.props.edit?a:t,icon:S}),e.jsx(R,{children:s}),e.jsx(q,{children:this.props.edit?a:t})]}),e.jsxs("div",{children:[f,m,e.jsx(j,{children:e.jsx(U,{onSubmit:this.saveHandler,icon:S,title:this.props.edit?a:t,list:i,link:"/user/brands",innerClassName:"row justify-content-center",children:c})})]})]})}}const G=r=>({...r}),K=r=>({show:n=>r(J(n)),info:()=>r(M()),post:n=>r(O(n)),patch:(n,s)=>r(P(n,s)),reset:()=>r(V())}),ds=H(G,K)(z);export{ds as default};
