var A=Object.defineProperty;var T=(o,r,s)=>r in o?A(o,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[r]=s;var d=(o,r,s)=>T(o,typeof r!="symbol"?r+"":r,s);import{c as w,r as D,j as e,N as q,C as F,R as x,a as B}from"./index-BncDn27B.js";import{B as R,S as E,a as P}from"./Subtitle-EIBA-Hk5.js";import{e as U}from"./Error-CC8F97pB.js";import{F as y,a as W}from"./Input-BldVOD2V.js";import{S as _}from"./index-3VnVM_zO.js";import{T as $}from"./index-C0jNRMwo.js";import{F as I}from"./Feedback-C0SvNv4r.js";import{a as J,p as M,b as O,r as V}from"./features-BGWhQVVm.js";import"./app-BShz7gyO.js";import"./BreadcrumbItem-BLbML1-v.js";import"./FormGroup-CjRq5iBt.js";import"./WithTooltip-yJJWpatI.js";const j="tools",C={name:"",prefix:"",add:!1};class z extends D.Component{constructor(){super(...arguments);d(this,"state",{...C});d(this,"saveHandler",s=>{var t,a,i,n,p;s.preventDefault(),this.props.edit?(i=(a=this.props).patch)==null||i.call(a,(t=this.props.match)==null?void 0:t.params.id,s.target):(p=(n=this.props).post)==null||p.call(n,s.target)});d(this,"saveAddHandler",()=>this.setState({add:!0},()=>{var s,t;return(t=(s=this.props).post)==null?void 0:t.call(s,document.querySelector("form"))}));d(this,"inputChangeHandler",s=>{const{name:t,value:a,files:i}=s.target;this.setState({[t]:i?i[0]:a})})}componentDidMount(){var s,t,a,i,n;(t=(s=this.props).reset)==null||t.call(s),this.props.edit&&((n=(i=this.props).get)==null||n.call(i,(a=this.props.match)==null?void 0:a.params.id))}componentDidUpdate(s){var t,a,i,n,p,l,m,c,h;if(!((a=(t=s.backend)==null?void 0:t.features)!=null&&a.message)&&((n=(i=this.props.backend)==null?void 0:i.features)!=null&&n.message)&&this.props.backend.features.message.type==="success"&&!this.props.edit&&(this.state.add?this.setState({...C}):(p=this.props.history)==null||p.push({pathname:"/user/features",state:{message:this.props.backend.features.message}})),!((m=(l=s.backend)==null?void 0:l.features)!=null&&m.feature)&&((h=(c=this.props.backend)==null?void 0:c.features)!=null&&h.feature)){const{backend:{features:{feature:u}}}=this.props;this.setState({...u})}}componentWillUnmount(){var s,t;(t=(s=this.props).reset)==null||t.call(s)}render(){var S,v,k;if(!((S=this.props.content)!=null&&S.cms)||!((v=this.props.backend)!=null&&v.features)||!((k=this.props.auth)!=null&&k.data))return null;let{content:{cms:{pages:{backend:{pages:{features:{title:s,add:t,edit:a,index:i,form:n}}}}}},backend:{features:{loading:p,error:l,message:m}},auth:{data:{role:{features:c}}}}=this.props,{name:h,prefix:u}=this.state,f=null,g=null;const b=c.find(N=>N.prefix==="features"),H=!(b&&JSON.parse(b.permissions).includes(this.props.edit?"u":"c"))&&e.jsx(q,{to:"/user/dashboard"});return p?f=e.jsx(F,{xs:12,children:e.jsx(B,{})}):(g=e.jsx(e.Fragment,{children:e.jsx(U,{err:l})}),f=e.jsx(e.Fragment,{children:e.jsxs(F,{xl:9,children:[e.jsx(I,{message:m}),this.props.edit&&e.jsx("input",{type:"hidden",name:"_method",defaultValue:"PATCH"}),e.jsx("div",{className:"shadow-lg rounded-8 bg-white px-4 px-sm-5 py-3 py-sm-4",children:e.jsxs(x,{className:"my-2 my-sm-3",children:[e.jsx("div",{className:"col-lg-9",children:e.jsxs(x,{children:[e.jsx(y,{type:"text",className:"col-md-6",icon:j,onChange:this.inputChangeHandler,value:h,name:"name",required:!0,placeholder:n.name}),e.jsx(y,{type:"text",className:"col-md-6",icon:"anchor",onChange:this.inputChangeHandler,value:u,name:"prefix",required:!0,placeholder:n.prefix})]})}),e.jsx(_,{edit:!!this.props.edit,saveAddHandler:this.saveAddHandler})]})})]})})),e.jsxs(e.Fragment,{children:[e.jsxs($,{children:[e.jsx(R,{items:this.props.edit?[{to:"/user/features",content:i}]:void 0,main:this.props.edit?a:t,icon:j}),e.jsx(E,{children:s}),e.jsx(P,{children:this.props.edit?a:t})]}),e.jsxs("div",{children:[H,g,e.jsx(x,{children:e.jsx(W,{onSubmit:this.saveHandler,icon:j,title:this.props.edit?a:t,list:i,link:"/user/features",innerClassName:"row justify-content-center",children:f})})]})]})}}const G=o=>({...o}),K=o=>({show:r=>o(J(r)),post:r=>o(M(r)),patch:(r,s)=>o(O(r,s)),reset:()=>o(V())}),pe=w(G,K)(z);export{pe as default};
